
![image](https://github.com/hinswhale/AI-Learning/assets/22999866/fc4177b7-df8e-40d1-921c-a39a73421435)

+--------------------------------------+
|                GPU                   |
|  +---------+    +---------+          |
|  |   SM    |    |   SM    |  ...     |
|  | +-----+ |    | +-----+ |          |
|  | |L1   | |    | |L1   | |          |
|  | |Cache | |    | |Cache | |          |
|  | +-----+ |    | +-----+ |          |
|  | +-----+ |    | +-----+ |          |
|  | |FP32 | |    | |FP32 | |          |
|  | |Core | |    | |Core | |          |
|  | +-----+ |    | +-----+ |          |
|  | +-----+ |    | +-----+ |          |
|  | |FP64 | |    | |FP64 | |          |
|  | |Core | |    | |Core | |          |
|  | +-----+ |    | +-----+ |          |
|  | +-----+ |    | +-----+ |          |
|  | |Tensor| |    | |Tensor| |          |
|  | |Core  | |    | |Core  | |          |
|  | +-----+ |    | +-----+ |          |
|  +---------+    +---------+          |
|      |               |               |
|      +---------------+               |
|           L2 Cache                    |
|          +---------+                  |
|          | Memory  |                  |
|          |Controller|                 |
|          +---------+                  |
|      |                |               |
|      +----------------+               |
|        High Bandwidth Memory (HBM)    |
|      |                |               |
|      +----------------+               |
|          PCIe Interface               |
+--------------------------------------+

attention QKV 计算
分块矩阵，然后是 loop（outer loop，inner loop，对应的是 gpu cuda 的 kernel 优化）；
